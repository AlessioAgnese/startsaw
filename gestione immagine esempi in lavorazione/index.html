<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"> </script>
</head>
<body>
<input type="file" name="afile" id="afile" accept="image/*"/>
<script>
document.querySelector('#afile').addEventListener('change', function(e) {
  var file = this.files[0];
  var fd = new FormData();
  fd.append("afile", file);
  var xhr = new XMLHttpRequest();
  xhr.open('POST', 'manageImg.php', true);
  xhr.send(fd);
  xhr.upload.onprogress = function(e) {
  var percentComplete=0;
  while(1){  
    if (e.lengthComputable) {
      percentComplete = (e.loaded / e.total) * 100;
    }
    if(percentComplete == 100){location.reload(); break;} }
  };
}, false);

$(document).ready(function (){
        $.ajax({
            url:'http://localhost/manageImg.php',
            type:'GET',
            dataType:'json',
            success:function(data){
                if(data.ok){
                //$.each(data.dataUrl, function(index){
                var image = document.createElement('img');
                image.src = data.dataUrl;//[index];
                document.body.appendChild(image);
                //});
                }else{
                    alert("FAIL");
                    }
            },
            error:function(errorThrown){
                console.log(errorThrown);
            }
        })
    });
</script>
</body>
</html>